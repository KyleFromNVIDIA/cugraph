RUNNING: "python -m distributed.cli.dask_scheduler --protocol=tcp
                    --scheduler-file /root/work/cugraph/mg_utils/dask-scheduler.json
                "
/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/cli/dask_scheduler.py:140: FutureWarning: dask-scheduler is deprecated and will be removed in a future release; use `dask scheduler` instead
  warnings.warn(
2023-06-22 21:18:44,592 - distributed.scheduler - INFO - -----------------------------------------------
2023-06-22 21:18:45,064 - distributed.scheduler - INFO - State start
2023-06-22 21:18:45,065 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-scratch-space/worker-j8j3rqxj', purging
2023-06-22 21:18:45,066 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-scratch-space/worker-o2nik00d', purging
2023-06-22 21:18:45,066 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-scratch-space/worker-0ckj2otm', purging
2023-06-22 21:18:45,066 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-scratch-space/worker-3esxu5t3', purging
2023-06-22 21:18:45,066 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-scratch-space/worker-8qh4h70y', purging
2023-06-22 21:18:45,067 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-scratch-space/worker-z94umjmd', purging
2023-06-22 21:18:45,067 - distributed.diskutils - INFO - Found stale lock file and directory '/tmp/dask-scratch-space/worker-h9t89j5d', purging
2023-06-22 21:18:45,184 - distributed.scheduler - INFO - -----------------------------------------------
2023-06-22 21:18:45,185 - distributed.scheduler - INFO -   Scheduler at:  tcp://10.33.227.169:8786
2023-06-22 21:18:45,185 - distributed.scheduler - INFO -   dashboard at:  http://10.33.227.169:8787/status
2023-06-22 21:18:56,582 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:46823', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,860 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:46823
2023-06-22 21:18:56,860 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40342
2023-06-22 21:18:56,861 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:37927', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,861 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:37927
2023-06-22 21:18:56,861 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40358
2023-06-22 21:18:56,862 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:42881', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,862 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:42881
2023-06-22 21:18:56,862 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40328
2023-06-22 21:18:56,863 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:39665', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,863 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:39665
2023-06-22 21:18:56,863 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40378
2023-06-22 21:18:56,864 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:34955', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,864 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:34955
2023-06-22 21:18:56,864 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40384
2023-06-22 21:18:56,865 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:46481', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,865 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:46481
2023-06-22 21:18:56,865 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40362
2023-06-22 21:18:56,866 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:33003', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,866 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:33003
2023-06-22 21:18:56,866 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40404
2023-06-22 21:18:56,867 - distributed.scheduler - INFO - Register worker <WorkerState 'tcp://10.33.227.169:44859', status: init, memory: 0, processing: 0>
2023-06-22 21:18:56,867 - distributed.scheduler - INFO - Starting worker compute stream, tcp://10.33.227.169:44859
2023-06-22 21:18:56,867 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:40398
2023-06-22 21:19:02,501 - distributed.scheduler - INFO - Receive client connection: Client-692a085e-1142-11ee-9e4a-d8c49778ced7
2023-06-22 21:19:02,501 - distributed.core - INFO - Starting established connection to tcp://10.33.227.169:34788
2023-06-22 21:19:02,583 - distributed.worker - INFO - Run out-of-band function '_func_set_scheduler_as_nccl_root'
2023-06-22 21:19:50,820 - distributed.core - INFO - Event loop was unresponsive in Scheduler for 7.89s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-06-22 21:19:50,824 - tornado.application - ERROR - Uncaught exception GET /tasks/ws (10.20.237.237)
HTTPServerRequest(protocol='http', host='10.33.227.169:8787', method='GET', uri='/tasks/ws', version='HTTP/1.1', remote_ip='10.20.237.237')
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/tornado/websocket.py", line 937, in _accept_connection
    open_result = handler.open(*handler.open_args, **handler.open_kwargs)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/tornado/web.py", line 3290, in wrapper
    return method(self, *args, **kwargs)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/bokeh/server/views/ws.py", line 149, in open
    raise ProtocolError("Token is expired.")
bokeh.protocol.exceptions.ProtocolError: Token is expired.
2023-06-22 21:19:53,137 - distributed.worker - INFO - Run out-of-band function 'lambda'
2023-06-22 21:19:56,938 - distributed.core - INFO - Event loop was unresponsive in Scheduler for 3.53s.  This is often caused by long-running GIL-holding functions or moving large chunks of data. This can cause timeouts and instability.
2023-06-22 21:20:01,881 - distributed.worker - INFO - Run out-of-band function '_func_destroy_scheduler_session'
2023-06-22 21:20:01,882 - distributed.scheduler - INFO - Remove client Client-692a085e-1142-11ee-9e4a-d8c49778ced7
2023-06-22 21:20:01,889 - distributed.core - INFO - Received 'close-stream' from tcp://10.33.227.169:34788; closing.
2023-06-22 21:20:01,890 - distributed.scheduler - INFO - Remove client Client-692a085e-1142-11ee-9e4a-d8c49778ced7
2023-06-22 21:20:01,891 - distributed.scheduler - INFO - Close client connection: Client-692a085e-1142-11ee-9e4a-d8c49778ced7
2023-06-22 21:27:56,084 - distributed._signals - INFO - Received signal SIGINT (2)
2023-06-22 21:27:56,085 - distributed.core - INFO - Connection to tcp://10.33.227.169:40398 has been closed.
2023-06-22 21:27:56,085 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:44859', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,087 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:44859
2023-06-22 21:27:56,087 - distributed.core - INFO - Connection to tcp://10.33.227.169:40362 has been closed.
2023-06-22 21:27:56,088 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:46481', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,088 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:46481
2023-06-22 21:27:56,088 - distributed.core - INFO - Connection to tcp://10.33.227.169:40342 has been closed.
2023-06-22 21:27:56,088 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:46823', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,088 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:46823
2023-06-22 21:27:56,088 - distributed.core - INFO - Connection to tcp://10.33.227.169:40404 has been closed.
2023-06-22 21:27:56,088 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:33003', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,088 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:33003
2023-06-22 21:27:56,089 - distributed.core - INFO - Connection to tcp://10.33.227.169:40328 has been closed.
2023-06-22 21:27:56,089 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:42881', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,089 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:42881
2023-06-22 21:27:56,089 - distributed.scheduler - INFO - Scheduler closing...
2023-06-22 21:27:56,091 - distributed.core - INFO - Connection to tcp://10.33.227.169:40378 has been closed.
2023-06-22 21:27:56,091 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:39665', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,091 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:39665
2023-06-22 21:27:56,091 - distributed.core - INFO - Connection to tcp://10.33.227.169:40384 has been closed.
2023-06-22 21:27:56,091 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:34955', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,092 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:34955
2023-06-22 21:27:56,092 - distributed.batched - INFO - Batched Comm Closed <TCP (closed) Scheduler connection to worker local=tcp://10.33.227.169:8786 remote=tcp://10.33.227.169:40384>
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/comm/tcp.py", line 317, in write
    raise StreamClosedError()
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/batched.py", line 115, in _background_send
    nbytes = yield coro
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/tornado/gen.py", line 767, in run
    value = future.result()
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/comm/tcp.py", line 328, in write
    convert_stream_closed_error(self, e)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/comm/tcp.py", line 144, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) Scheduler connection to worker local=tcp://10.33.227.169:8786 remote=tcp://10.33.227.169:40384>: Stream is closed
2023-06-22 21:27:56,093 - distributed.batched - INFO - Batched Comm Closed <TCP (closed) Scheduler connection to worker local=tcp://10.33.227.169:8786 remote=tcp://10.33.227.169:40378>
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/comm/tcp.py", line 317, in write
    raise StreamClosedError()
tornado.iostream.StreamClosedError: Stream is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/batched.py", line 115, in _background_send
    nbytes = yield coro
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/tornado/gen.py", line 767, in run
    value = future.result()
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/comm/tcp.py", line 328, in write
    convert_stream_closed_error(self, e)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/comm/tcp.py", line 144, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc}") from exc
distributed.comm.core.CommClosedError: in <TCP (closed) Scheduler connection to worker local=tcp://10.33.227.169:8786 remote=tcp://10.33.227.169:40378>: Stream is closed
2023-06-22 21:27:56,094 - distributed.scheduler - INFO - Scheduler closing all comms
2023-06-22 21:27:56,095 - distributed.core - INFO - Connection to tcp://10.33.227.169:40358 has been closed.
2023-06-22 21:27:56,095 - distributed.scheduler - INFO - Remove worker <WorkerState 'tcp://10.33.227.169:37927', status: running, memory: 0, processing: 0>
2023-06-22 21:27:56,095 - distributed.core - INFO - Removing comms to tcp://10.33.227.169:37927
2023-06-22 21:27:56,095 - distributed.scheduler - INFO - Lost all workers
2023-06-22 21:27:56,098 - distributed.scheduler - INFO - Stopped scheduler at 'tcp://10.33.227.169:8786'
2023-06-22 21:27:56,098 - distributed.scheduler - INFO - End scheduler
